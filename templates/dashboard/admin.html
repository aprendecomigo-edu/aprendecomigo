{% extends 'base.html' %}

{% block title %}Admin Dashboard | Aprende Comigo{% endblock %}

{% block extra_css %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
<!-- Additional dashboard-specific CSS can be added here if needed -->
{% endblock %}

{% block content %}
<div class="container dashboard-container">
    <div class="row">
        <div class="col-md-12">
            <h1>Welcome, {{ user.name }}!</h1>
            <span class="badge bg-secondary">Admin</span>
            
            <!-- Admin actions section -->
            <div class="mt-4">
                <h3>Dashboard</h3>

                <!-- Class Sessions Section -->
                <h3 class="mt-4">Class Sessions</h3>
                <div class="filter-section">
                    <form hx-get="{% url 'filter_sessions' %}" hx-target="#sessions-table" hx-swap="outerHTML" hx-indicator="#filter-indicator">
                        <div class="row session-filters">
                            <div class="col-md-4 session-filter-item">
                                <div class="form-group">
                                    <label for="teacher">Teacher:</label>
                                    <select class="form-control" id="teacher" name="teacher">
                                        <option value="">All Teachers</option>
                                        {% for teacher in teachers %}
                                            <option value="{{ teacher.id }}" {% if selected_teacher == teacher.id %}selected{% endif %}>{{ teacher.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4 session-filter-item">
                                <div class="form-group">
                                    <label for="student">Student:</label>
                                    <select class="form-control" id="student" name="student">
                                        <option value="">All Students</option>
                                        {% for student in students %}
                                            <option value="{{ student.id }}" {% if selected_student == student.id %}selected{% endif %}>{{ student.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-2 session-filter-item">
                                <div class="form-group">
                                    <label for="start_date">From:</label>
                                    <input type="date" class="form-control" id="start_date" name="start_date" value="{{ start_date|date:'Y-m-d' }}">
                                </div>
                            </div>
                            <div class="col-md-2 session-filter-item">
                                <div class="form-group">
                                    <label for="end_date">To:</label>
                                    <input type="date" class="form-control" id="end_date" name="end_date" value="{{ end_date|date:'Y-m-d' }}">
                                </div>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-md-12">
                                <button type="submit" class="btn btn-secondary">
                                    Filter
                                    <span id="filter-indicator" class="htmx-indicator spinner-border spinner-border-sm ms-1" role="status"></span>
                                </button>
                                <button hx-get="{% url 'view_sessions' %}" hx-target="#sessions-table" class="btn btn-outline-secondary">Reset</button>
                            </div>
                        </div>
                    </form>
                </div>

                <div id="sessions-table" hx-get="{% url 'view_sessions' %}?page=1" hx-trigger="load once">
                    <div class="d-flex justify-content-center py-5">
                        <div class="spinner-border" role="status">
                            <span class="visually-hidden">Loading sessions...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
