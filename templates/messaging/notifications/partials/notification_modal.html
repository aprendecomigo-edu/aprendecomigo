<!-- Notification Modal - DaisyUI Modal Component -->
<dialog id="notification-modal" class="modal">
    <div class="modal-box w-11/12 max-w-2xl">
        <!-- Modal Header -->
        <div class="flex items-center justify-between border-b border-gray-200 pb-4 mb-4">
            <h3 class="text-lg font-semibold text-gray-900">Notifications</h3>
            <form method="dialog">
                <button class="btn btn-sm btn-circle btn-ghost">
                    <i data-lucide="x" class="h-4 w-4"></i>
                </button>
            </form>
        </div>

        <!-- Filter Section -->
        <div class="flex flex-wrap gap-3 mb-4" id="notification-filters">
            <div class="form-control">
                <label class="label">
                    <span class="label-text text-sm">Type</span>
                </label>
                <select name="notification_type"
                        class="select select-bordered select-sm w-40"
                        hx-get="/messaging/notifications/?modal=true"
                        hx-target="#notification-modal-content"
                        hx-trigger="change"
                        hx-include="[name='is_read']"
                        hx-vals='{"modal": "true"}'>
                    <option value="">All types</option>
                    <option value="LOW_BALANCE">Low Balance</option>
                    <option value="PACKAGE_EXPIRING">Package Expiring</option>
                    <option value="BALANCE_DEPLETED">Balance Depleted</option>
                </select>
            </div>

            <div class="form-control">
                <label class="label">
                    <span class="label-text text-sm">Status</span>
                </label>
                <select name="is_read"
                        class="select select-bordered select-sm w-40"
                        hx-get="/messaging/notifications/?modal=true"
                        hx-target="#notification-modal-content"
                        hx-trigger="change"
                        hx-include="[name='notification_type']"
                        hx-vals='{"modal": "true"}'>
                    <option value="">All notifications</option>
                    <option value="false">Unread only</option>
                    <option value="true">Read only</option>
                </select>
            </div>

            <button class="btn btn-outline btn-sm mt-8"
                    hx-get="/messaging/notifications/?modal=true"
                    hx-target="#notification-modal-content"
                    hx-vals='{"modal": "true"}'>
                <i data-lucide="refresh-ccw" class="h-4 w-4 mr-2"></i>
                Clear Filters
            </button>
        </div>

        <!-- Modal Content -->
        <div id="notification-modal-content" class="max-h-96 overflow-y-auto">
            <!-- Content will be loaded via HTMX -->
            <div class="flex items-center justify-center py-8">
                <span class="loading loading-spinner loading-md"></span>
            </div>
        </div>

        <!-- Modal Actions -->
        <div class="modal-action border-t border-gray-200 pt-4 mt-4">
            <form method="dialog">
                <button class="btn btn-outline">Close</button>
            </form>
        </div>
    </div>

    <!-- Modal backdrop - click to close -->
    <form method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
</dialog>

<script>
// Initialize modal icons when modal is shown
document.addEventListener('DOMContentLoaded', function() {
    const modal = document.getElementById('notification-modal');
    if (modal) {
        modal.addEventListener('open', function() {
            setTimeout(() => {
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                }
            }, 100);
        });
    }
});
</script>
