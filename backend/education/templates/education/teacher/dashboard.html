<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher Dashboard - Aprende Comigo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen">
        <!-- Header -->
        <header class="bg-white shadow-sm border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center py-6">
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">Teacher Dashboard</h1>
                        <p class="text-sm text-gray-600">Welcome back, {{ teacher.user.get_full_name }}!</p>
                    </div>
                    <div class="flex space-x-4">
                        <a href="{% url 'education:teacher_courses' %}" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">
                            Manage Courses
                        </a>
                        <a href="{% url 'education:create_course' %}" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg">
                            Create Course
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
            <!-- Stats Overview -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-white overflow-hidden shadow rounded-lg">
                    <div class="p-5">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
                                    <span class="text-white font-semibold">{{ total_courses }}</span>
                                </div>
                            </div>
                            <div class="ml-5 w-0 flex-1">
                                <dl>
                                    <dt class="text-sm font-medium text-gray-500 truncate">
                                        Total Courses
                                    </dt>
                                    <dd class="text-lg font-medium text-gray-900">
                                        {{ total_courses }}
                                    </dd>
                                </dl>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-white overflow-hidden shadow rounded-lg">
                    <div class="p-5">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
                                    <span class="text-white font-semibold">{{ active_courses }}</span>
                                </div>
                            </div>
                            <div class="ml-5 w-0 flex-1">
                                <dl>
                                    <dt class="text-sm font-medium text-gray-500 truncate">
                                        Active Courses
                                    </dt>
                                    <dd class="text-lg font-medium text-gray-900">
                                        {{ active_courses }}
                                    </dd>
                                </dl>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-white overflow-hidden shadow rounded-lg">
                    <div class="p-5">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center">
                                    <span class="text-white font-semibold">{{ total_students }}</span>
                                </div>
                            </div>
                            <div class="ml-5 w-0 flex-1">
                                <dl>
                                    <dt class="text-sm font-medium text-gray-500 truncate">
                                        Total Students
                                    </dt>
                                    <dd class="text-lg font-medium text-gray-900">
                                        {{ total_students }}
                                    </dd>
                                </dl>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-white overflow-hidden shadow rounded-lg">
                    <div class="p-5">
                        <div class="flex items-center">
                            <div class="flex-shrink-0">
                                <div class="w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center">
                                    <span class="text-white font-semibold">€</span>
                                </div>
                            </div>
                            <div class="ml-5 w-0 flex-1">
                                <dl>
                                    <dt class="text-sm font-medium text-gray-500 truncate">
                                        Total Revenue
                                    </dt>
                                    <dd class="text-lg font-medium text-gray-900">
                                        €{{ total_revenue }}
                                    </dd>
                                </dl>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Two Column Layout -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Recent Courses -->
                <div class="bg-white shadow rounded-lg">
                    <div class="px-4 py-5 sm:p-6">
                        <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">
                            Recent Courses
                        </h3>
                        {% if courses %}
                            <div class="flow-root">
                                <ul class="-my-5 divide-y divide-gray-200">
                                    {% for course in courses %}
                                    <li class="py-4">
                                        <div class="flex items-center space-x-4">
                                            <div class="flex-1 min-w-0">
                                                <p class="text-sm font-medium text-gray-900 truncate">
                                                    <a href="{% url 'education:course_detail' course.id %}" class="hover:text-blue-600">
                                                        {{ course.title }}
                                                    </a>
                                                </p>
                                                <p class="text-sm text-gray-500">
                                                    {{ course.subject.name }} • {{ course.enrolled_students_count }} students
                                                </p>
                                            </div>
                                            <div class="flex-shrink-0">
                                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                                                    {% if course.status == 'active' %}bg-green-100 text-green-800
                                                    {% elif course.status == 'published' %}bg-blue-100 text-blue-800
                                                    {% else %}bg-gray-100 text-gray-800{% endif %}">
                                                    {{ course.get_status_display }}
                                                </span>
                                            </div>
                                        </div>
                                    </li>
                                    {% endfor %}
                                </ul>
                            </div>
                        {% else %}
                            <p class="text-gray-500 text-center py-4">No courses yet. <a href="{% url 'education:create_course' %}" class="text-blue-600 hover:text-blue-500">Create your first course</a></p>
                        {% endif %}
                    </div>
                </div>

                <!-- Upcoming Lessons -->
                <div class="bg-white shadow rounded-lg">
                    <div class="px-4 py-5 sm:p-6">
                        <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">
                            Upcoming Lessons
                        </h3>
                        {% if upcoming_lessons %}
                            <div class="flow-root">
                                <ul class="-my-5 divide-y divide-gray-200">
                                    {% for lesson in upcoming_lessons %}
                                    <li class="py-4">
                                        <div class="flex items-center space-x-4">
                                            <div class="flex-1 min-w-0">
                                                <p class="text-sm font-medium text-gray-900 truncate">
                                                    {{ lesson.title }}
                                                </p>
                                                <p class="text-sm text-gray-500">
                                                    {{ lesson.course.title }} • {{ lesson.scheduled_date|date:"M d, H:i" }}
                                                </p>
                                            </div>
                                            <div class="flex-shrink-0 text-sm text-gray-500">
                                                {{ lesson.duration_minutes }}min
                                            </div>
                                        </div>
                                    </li>
                                    {% endfor %}
                                </ul>
                            </div>
                        {% else %}
                            <p class="text-gray-500 text-center py-4">No upcoming lessons scheduled.</p>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Recent Enrollments -->
            {% if recent_enrollments %}
            <div class="mt-6">
                <div class="bg-white shadow rounded-lg">
                    <div class="px-4 py-5 sm:p-6">
                        <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">
                            Recent Enrollments
                        </h3>
                        <div class="flow-root">
                            <ul class="-my-5 divide-y divide-gray-200">
                                {% for enrollment in recent_enrollments %}
                                <li class="py-4">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-4">
                                            <div class="flex-1 min-w-0">
                                                <p class="text-sm font-medium text-gray-900 truncate">
                                                    {{ enrollment.student.user.get_full_name }}
                                                </p>
                                                <p class="text-sm text-gray-500">
                                                    Enrolled in {{ enrollment.course.title }}
                                                </p>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <span class="text-sm text-gray-500">{{ enrollment.enrollment_date|date:"M d" }}</span>
                                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                                                {% if enrollment.is_paid %}bg-green-100 text-green-800
                                                {% else %}bg-yellow-100 text-yellow-800{% endif %}">
                                                {% if enrollment.is_paid %}Paid{% else %}Pending{% endif %}
                                            </span>
                                        </div>
                                    </div>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Quick Actions -->
            {% if pending_assignments > 0 %}
            <div class="mt-6">
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <svg class="h-5 w-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-yellow-800">
                                Pending Assignment Reviews
                            </h3>
                            <div class="mt-2 text-sm text-yellow-700">
                                <p>You have {{ pending_assignments }} assignment submissions waiting for your review.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
        </main>
    </div>
</body>
</html>