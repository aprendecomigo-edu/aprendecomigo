QA Test Case: Cross-User Visibility and Class Synchronization

Test ID: SCHED-004
Test Name: Cross-User Visibility and Class Synchronization
Purpose: Verify that when a student schedules a class, the teacher sees it in their calendar and vice versa
Expected Result: Classes scheduled by one user appear correctly in relevant users' calendars

=== CONTEXT (Pre-test Requirements) ===

System Information:
- Project: Aprende Comigo - Educational platform
- Architecture: Django REST backend + React Native frontend
- Cross-User Visibility: Students see their classes, teachers see classes they teach, admins see all
- Synchronization: Classes appear in all relevant user calendars

Required Environment Setup:
1. Project Location: /Users/anapmc/Code/aprendecomigo/
2. Python Virtual Environment: .venv/ in project root
3. Environment Variables:
   - DJANGO_ENV=development
   - EXPO_PUBLIC_ENV=development

Test Data:
- Student Email: student.test@example.com
- Teacher Email: teacher.test@example.com
- Admin Email: admin.test@example.com
- School Name: "Test School"
- Test Class: "Cross-User Visibility Test"

=== DETAILED STEP-BY-STEP INSTRUCTIONS ===

Step 1: Environment Setup
Commands:
  cd /Users/anapmc/Code/aprendecomigo
  source .venv/bin/activate
  make dev

Expected: Both servers start successfully
Screenshot: 01_servers_started.png

Step 2: Student Books Class
1. Login as student: student.test@example.com
2. Navigate to calendar
3. Click "Book Class"
4. Select teacher: teacher.test@example.com
5. Select future date and time
6. Fill details: Title "Cross-User Visibility Test"
7. Submit booking

Expected: Student successfully books class
Screenshot: 02_student_books_class.png

Step 3: Verify Student Sees Class
1. Check student's calendar
2. Verify class appears with correct details
3. Note exact time and date
4. Check class status is "Scheduled"

Expected: Class appears in student's calendar
Screenshot: 03_student_sees_class.png

Step 4: Switch to Teacher Account
1. Logout from student account
2. Login as teacher: teacher.test@example.com
3. Navigate to calendar
4. Wait for calendar to load

Expected: Teacher login successful and calendar loads
Screenshot: 04_teacher_login.png

Step 5: Verify Teacher Sees Student's Class
1. Check teacher's calendar for the scheduled class
2. Verify class shows:
   - Correct title: "Cross-User Visibility Test"
   - Correct student name
   - Correct date and time
   - Status: "Scheduled"
3. Verify teacher can see they are the assigned teacher

Expected: Teacher sees student's booking in their calendar
Screenshot: 05_teacher_sees_student_class.png

Step 6: Switch to Admin Account
1. Logout from teacher account
2. Login as admin: admin.test@example.com
3. Navigate to calendar
4. Wait for calendar to load

Expected: Admin login successful and calendar loads
Screenshot: 06_admin_login.png

Step 7: Verify Admin Sees All Classes
1. Check admin's calendar
2. Verify admin can see the same class
3. Verify admin sees:
   - Student name
   - Teacher name
   - All class details
   - "Booked by" information

Expected: Admin sees all classes including student's booking
Screenshot: 07_admin_sees_all_classes.png

Step 8: Test Real-Time Synchronization
1. Switch back to student account
2. Book another class with same teacher
3. Immediately switch to teacher account
4. Verify new class appears in teacher's calendar

Expected: New class appears in teacher's calendar
Screenshot: 08_realtime_sync.png

Step 9: Test Class Updates
1. Login as teacher
2. Confirm a scheduled class
3. Switch to student account
4. Verify class status changed to "Confirmed"

Expected: Class status updates appear for all users
Screenshot: 09_status_updates.png

Step 10: Backend Verification
Commands:
  cd /Users/anapmc/Code/aprendecomigo/backend
  python manage.py shell -c "
  from scheduler.models import ClassSchedule
  from accounts.models import CustomUser

  class_schedule = ClassSchedule.objects.filter(title='Cross-User Visibility Test').first()
  if class_schedule:
      print(f'Class: {class_schedule.title}')
      print(f'Student: {class_schedule.student.name}')
      print(f'Teacher: {class_schedule.teacher.user.name}')
      print(f'Booked by: {class_schedule.booked_by.name}')
      print(f'Status: {class_schedule.status}')

      # Check visibility for each user
      student_classes = ClassSchedule.objects.filter(student=class_schedule.student)
      teacher_classes = ClassSchedule.objects.filter(teacher=class_schedule.teacher)

      print(f'Student sees {student_classes.count()} classes')
      print(f'Teacher sees {teacher_classes.count()} classes')
  "

Expected: Backend confirms proper class relationships
Screenshot: 10_backend_verification.png

=== PASS/FAIL CRITERIA ===

PASS: Student schedules class AND teacher sees it in their calendar AND admin sees it in comprehensive view AND class details match across all users AND real-time synchronization works

FAIL: Class not visible to teacher OR class not visible to admin OR details don't match OR synchronization doesn't work

Overall Result: PASS only if ALL steps pass, FAIL if ANY step fails

=== SPECIAL CONSIDERATIONS ===

Cross-User Visibility:
- Students see classes they book
- Teachers see classes they teach
- Admins see all classes
- Details consistent across all views

Real-Time Synchronization:
- Classes appear immediately in relevant calendars
- Status updates propagate to all users
- No delays or sync issues

Data Integrity:
- Class relationships maintained properly
- User information accurate across views
- Database consistency verified
