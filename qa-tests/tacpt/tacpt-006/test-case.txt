QA Test Case: Authentication Mismatch Handling

Test ID: TACPT-006
Test Name: Authentication Mismatch Handling
Purpose: Verify proper handling when logged-in user email doesn't match invitation email
Expected Result: Clear error message with authentication guidance for correct email

=== CONTEXT (Pre-test Requirements) ===

System Information:
- Project: Aprende Comigo Platform
- Architecture: Django backend (localhost:8000) + React Native frontend (localhost:8081)
- GitHub Issue: #52 - Authentication mismatch error handling

Required Environment Setup:
1. Project Location: /Users/anapmc/Code/aprendecomigo
2. Python Virtual Environment: .venv/ in project root
3. Development servers: `make dev`
4. Database: PostgreSQL with test data

Test Data:
- Invitation Email: invitation.target@aprendecomigo.com
- Different User Email: different.user@aprendecomigo.com (logged in)
- Valid invitation token for invitation.target@aprendecomigo.com
- Active user account for different.user@aprendecomigo.com

=== DETAILED STEP-BY-STEP INSTRUCTIONS ===

Step 1: Environment and User Setup
1. Start development servers
2. Create/verify test users exist
3. Prepare valid invitation for invitation.target@aprendecomigo.com
Commands:
  cd /Users/anapmc/Code/aprendecomigo
  make dev

Expected: Servers running, test data prepared
Screenshot: 01_test_data_prepared.png

Step 2: Authenticate as Different User
1. Navigate to login page
2. Login as different.user@aprendecomigo.com
3. Verify authentication successful
URL: http://localhost:8081/auth/signin

Expected: Successfully logged in as wrong user
Screenshot: 02_wrong_user_authenticated.png

Step 3: Access Invitation with Mismatched User
1. Navigate to invitation URL while logged in as wrong user
2. Observe system behavior
URL: http://localhost:8081/accept-invitation/[INVITATION_TOKEN]

Expected: System detects email mismatch
Screenshot: 03_mismatch_detected.png

Step 4: Verify Mismatch Error Message
1. Confirm clear error message about email mismatch
2. Check message mentions correct email needed
3. Verify professional, helpful tone
4. Check message is in Portuguese

Expected: Clear mismatch error with guidance
Screenshot: 04_mismatch_error_message.png

Step 5: Test Authentication Options
1. Check for "Login with correct email" option
2. Verify "Switch account" functionality if available
3. Test logout and re-login flow
4. Confirm user can access correct authentication

Expected: Clear path to authenticate with correct email
Screenshot: 05_authentication_options.png

Step 6: Complete Correct Authentication Flow
1. Logout or switch to correct account
2. Login as invitation.target@aprendecomigo.com
3. Return to invitation URL
4. Verify invitation now works properly

Expected: Invitation acceptance works with correct user
Screenshot: 06_correct_authentication_success.png

Step 7: Verify Security Considerations
1. Confirm invitation details not exposed to wrong user
2. Check that wrong user cannot accept invitation
3. Verify no bypass mechanisms available
4. Test multiple mismatch scenarios

Expected: Strong security with no information leakage
Screenshot: 07_security_verification.png

=== PASS/FAIL CRITERIA ===

PASS: Mismatch detected with clear guidance and security maintained
FAIL: Security bypass possible or poor user experience

Overall Result: PASS only if ALL steps pass, FAIL if ANY step fails